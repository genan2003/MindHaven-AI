<div *ngIf="app" class="app-details">
  <h2>{{ app.name }}</h2>
  <p>{{ app.description }}</p>

  <h3>Reviews</h3>
  <div *ngFor="let review of reviews" class="review">
    <p>{{ review.username }}</p>
    <p><strong>Rating:</strong> {{ review.rating }}/5</p>
    <p>{{ review.reviewText }}</p>
    <!-- Only show delete button if loggedInUserId is available and matches the review's userId -->
    <button
      *ngIf="loggedInUserId && review.userId === loggedInUserId"
      (click)="deleteReview(review.reviewId!)"
    >
      Delete Review
    </button>
  </div>

  <form *ngIf="canSubmitReview; else alreadyReviewed" (ngSubmit)="submitReview()">
    <label for="rating">Rating:</label>
    <input
      type="number"
      id="rating"
      [(ngModel)]="newReview.rating"
      name="rating"
      required
      min="1"
      max="5"
    />
    <label for="reviewText">Review:</label>
    <textarea
      id="reviewText"
      [(ngModel)]="newReview.reviewText"
      name="reviewText"
      required
    ></textarea>
    <button type="submit">Submit Review</button>
  </form>

  <ng-template #alreadyReviewed>
    <p>You have already submitted a review for this app.</p>
  </ng-template>
</div>
